function r = H_inv(x,y,z)
dx = 0.000000001;
a1 = (f(x+dx,y,z) - f(x,y,z))/dx;

%%
dy = 0.000000001; 
a2 = (f(x,y+dy,z) - f(x,y,z))/dy;

%%
dz = 0.000000001;
[d_f,d] = f(x,y,z);
 
a3 = (f(x,y,z+dz) - f(x,y,z))/dz;

%%
aa = [a1 a2 a3];

%%
H(1,1) = 2*(aa(1,1)^2 + aa(2,1)^2+ aa(3,1)^2+ aa(4,1)^2);
H(1,2) = 2*(aa(1,1)*aa(1,2) + aa(2,1)*aa(2,2) + aa(3,1)*aa(3,2) + aa(4,1)*aa(4,2));
H(1,3) = 2*(aa(1,1)*aa(1,3) + aa(2,1)*aa(2,3) + aa(3,1)*aa(3,3) + aa(4,1)*aa(4,3));
H(2,2) = 2*(aa(1,2)^2 + aa(2,2)^2+ aa(3,2)^2+ aa(4,2)^2);
H(2,3) = 2*(aa(1,2)*aa(1,3) + aa(2,2)*aa(2,3) + aa(3,2)*aa(3,3) + aa(4,2)*aa(4,3));
H(3,3) = 2*(aa(1,3)^2 + aa(2,3)^2+ aa(3,3)^2+ aa(4,3)^2);
H(2,1) = H(1,2);
H(3,1) = H(1,3);
H(3,2) = H(2,3);

H_inv = H^(-1);
%% del of chai-square 

del_1 = -2*(d(1)-d_f(1)) * [aa(1,1); aa(1,2); aa(1,3)];
del_2 = -2*(d(2)-d_f(2)) * [aa(2,1); aa(2,2); aa(2,3)];
del_3 = -2*(d(3)-d_f(3)) * [aa(3,1); aa(3,2); aa(3,3)];
del_4 = -2*(d(4)-d_f(4)) * [aa(4,1); aa(4,2); aa(4,3)];

del = del_1 + del_2 + del_3 + del_4;
%% H^-1 * del
r = H_inv * del;